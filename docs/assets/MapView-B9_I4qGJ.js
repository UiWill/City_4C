import{d as E,a as c,r as F,q as R,D as j,y as $,c as i,b as e,f as r,g as f,s as g,e as _,F as k,z as b,t as l,n as y,C,B as M,o as A,p as d,_ as T}from"./index-DjO_doMe.js";import{f as N,p as P}from"./pt-BR-BZBxiJ23.js";const H={class:"map-view"},I={class:"map-controls"},U={class:"controls-left"},q={class:"filter-group"},G={class:"filter-group"},J=["value"],K={class:"controls-right"},Q={class:"occurrence-count"},W={class:"map-container"},X={class:"map-placeholder"},Y={class:"mock-markers"},Z=["onClick"],ee={class:"marker-tooltip"},te={class:"tooltip-content"},se={key:0},ae={class:"coordinates"},oe={key:0,class:"occurrence-panel"},le={class:"panel-header"},ne={class:"panel-content"},ie={class:"occurrence-info"},de={class:"info-item"},re={key:0,class:"info-item"},ce={class:"info-item"},ve={class:"coordinates"},ue={key:1,class:"info-item"},pe={class:"info-item"},me={key:2,class:"info-item description"},fe={class:"panel-actions"},ge={key:1,class:"loading-overlay"},_e=E({__name:"MapView",setup(ke){const h=A(),p=c([]),m=c([]),a=c(null),v=c(!1),n=F({status:"",tag_id:""}),u=R(()=>{let s=p.value;return n.status&&(s=s.filter(t=>t.status===n.status)),n.tag_id&&(s=s.filter(t=>t.tag_id===Number(n.tag_id))),s}),w=async()=>{v.value=!0;try{p.value=await M.getOccurrences({limit:100})}catch(s){console.error("Error loading occurrences:",s)}finally{v.value=!1}},x=async()=>{try{m.value=await M.getTags()}catch(s){console.error("Error loading tags:",s)}},L=()=>{n.status="",n.tag_id=""},V=s=>{a.value=s},O=s=>{h.push(`/occurrences/${s}`)},S=s=>{const t=[{top:"20%",left:"30%"},{top:"40%",left:"60%"},{top:"60%",left:"25%"},{top:"35%",left:"80%"},{top:"70%",left:"50%"},{top:"25%",left:"70%"},{top:"55%",left:"40%"},{top:"80%",left:"35%"},{top:"15%",left:"55%"},{top:"45%",left:"15%"}];return t[s%t.length]},z=s=>N(new Date(s),"dd/MM/yyyy HH:mm",{locale:P}),B=s=>({pending:"Pendente",in_progress:"Em Andamento",resolved:"Resolvido",rejected:"Rejeitado"})[s]||s;return j(n,()=>{a.value=null},{deep:!0}),$(()=>{x(),w()}),(s,t)=>(d(),i("div",H,[e("div",I,[e("div",U,[e("div",q,[t[5]||(t[5]=e("label",{for:"map-status-filter",class:"filter-label"},"Status",-1)),f(e("select",{id:"map-status-filter","onUpdate:modelValue":t[0]||(t[0]=o=>n.status=o),class:"form-select"},t[4]||(t[4]=[_('<option value="" data-v-2938d1ef>Todos</option><option value="pending" data-v-2938d1ef>Pendente</option><option value="in_progress" data-v-2938d1ef>Em Andamento</option><option value="resolved" data-v-2938d1ef>Resolvido</option><option value="rejected" data-v-2938d1ef>Rejeitado</option>',5)]),512),[[g,n.status]])]),e("div",G,[t[7]||(t[7]=e("label",{for:"map-tag-filter",class:"filter-label"},"Categoria",-1)),f(e("select",{id:"map-tag-filter","onUpdate:modelValue":t[1]||(t[1]=o=>n.tag_id=o),class:"form-select"},[t[6]||(t[6]=e("option",{value:""},"Todas",-1)),(d(!0),i(k,null,b(m.value,o=>(d(),i("option",{key:o.id,value:o.id},l(o.name),9,J))),128))],512),[[g,n.tag_id]])]),e("button",{onClick:L,class:"btn btn-secondary"}," Limpar Filtros ")]),e("div",K,[e("div",Q,l(u.value.length)+" ocorrência"+l(u.value.length!==1?"s":"")+" no mapa ",1)])]),e("div",W,[e("div",X,[t[9]||(t[9]=e("div",{class:"map-content"},[e("svg",{class:"map-icon",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M20.5 3l-.16.03L15 5.1 9 3 3.36 4.9c-.21.07-.36.25-.36.48V20.5c0 .28.22.5.5.5l.16-.03L9 18.9l6 2.1 5.64-1.9c.21-.07.36-.25.36-.48V3.5c0-.28-.22-.5-.5-.5z"})]),e("h3",null,"Mapa Interativo"),e("p",null,"Esta funcionalidade será implementada com Leaflet/OpenStreetMap na versão completa."),e("p",null,"As ocorrências aparecerão como marcadores coloridos baseados no status.")],-1)),e("div",Y,[(d(!0),i(k,null,b(u.value.slice(0,10),(o,D)=>(d(),i("div",{key:o.id,class:y(["mock-marker",`marker--${o.status.replace("_","-")}`]),style:C(S(D)),onClick:be=>V(o)},[t[8]||(t[8]=e("div",{class:"marker-icon"},[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})])],-1)),e("div",ee,[e("div",te,[e("h4",null,l(o.title||"Ocorrência sem título"),1),o.tags?(d(),i("p",se,l(o.tags.name),1)):r("",!0),e("p",ae,l(o.latitude.toFixed(4))+", "+l(o.longitude.toFixed(4)),1)])])],14,Z))),128))])]),t[10]||(t[10]=_('<div class="map-legend" data-v-2938d1ef><h4 data-v-2938d1ef>Legenda</h4><div class="legend-items" data-v-2938d1ef><div class="legend-item" data-v-2938d1ef><div class="legend-marker marker--pending" data-v-2938d1ef></div><span data-v-2938d1ef>Pendente</span></div><div class="legend-item" data-v-2938d1ef><div class="legend-marker marker--in-progress" data-v-2938d1ef></div><span data-v-2938d1ef>Em Andamento</span></div><div class="legend-item" data-v-2938d1ef><div class="legend-marker marker--resolved" data-v-2938d1ef></div><span data-v-2938d1ef>Resolvido</span></div><div class="legend-item" data-v-2938d1ef><div class="legend-marker marker--rejected" data-v-2938d1ef></div><span data-v-2938d1ef>Rejeitado</span></div></div></div>',1))]),a.value?(d(),i("div",oe,[e("div",le,[e("h3",null,l(a.value.title||"Ocorrência sem título"),1),e("button",{onClick:t[2]||(t[2]=o=>a.value=null),class:"close-button"},t[11]||(t[11]=[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]))]),e("div",ne,[e("div",ie,[e("div",de,[t[12]||(t[12]=e("span",{class:"label"},"Status:",-1)),e("span",{class:y(["status-badge",`status-badge--${a.value.status.replace("_","-")}`])},l(B(a.value.status)),3)]),a.value.tags?(d(),i("div",re,[t[13]||(t[13]=e("span",{class:"label"},"Categoria:",-1)),e("span",{class:"tag-badge",style:C({backgroundColor:a.value.tags.color+"20",color:a.value.tags.color})},l(a.value.tags.name),5)])):r("",!0),e("div",ce,[t[14]||(t[14]=e("span",{class:"label"},"Localização:",-1)),e("span",ve,l(a.value.latitude.toFixed(6))+", "+l(a.value.longitude.toFixed(6)),1)]),a.value.address?(d(),i("div",ue,[t[15]||(t[15]=e("span",{class:"label"},"Endereço:",-1)),e("span",null,l(a.value.address),1)])):r("",!0),e("div",pe,[t[16]||(t[16]=e("span",{class:"label"},"Data:",-1)),e("span",null,l(z(a.value.created_at)),1)]),a.value.description?(d(),i("div",me,[t[17]||(t[17]=e("span",{class:"label"},"Descrição:",-1)),e("p",null,l(a.value.description),1)])):r("",!0)]),e("div",fe,[e("button",{onClick:t[3]||(t[3]=o=>O(a.value.id)),class:"btn btn-primary"}," Ver Detalhes ")])])])):r("",!0),v.value?(d(),i("div",ge,t[18]||(t[18]=[e("div",{class:"spinner"},null,-1),e("p",null,"Carregando ocorrências...",-1)]))):r("",!0)]))}}),Me=T(_e,[["__scopeId","data-v-2938d1ef"]]);export{Me as default};
