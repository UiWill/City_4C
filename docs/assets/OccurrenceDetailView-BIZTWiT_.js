import{d as X,a as u,D as pe,y as ee,E as J,G as me,c as n,n as q,b as e,f as c,t as o,p as i,_ as se,H as _e,q as ge,j as g,C as I,g as B,s as H,e as fe,w as ye,v as be,F as K,z as Q,k as he,B as f}from"./index-CXINJcXc.js";import{L as V}from"./leaflet-BxG-sHK_.js";import{f as Ce,p as we}from"./pt-BR-BZBxiJ23.js";const ke={key:0,class:"address-overlay"},ze={class:"address-content"},Ae=X({__name:"OccurrenceMap",props:{occurrence:{},size:{default:"large"},zoom:{default:15},showPopup:{type:Boolean,default:!1}},setup(Z){delete V.Icon.Default.prototype._getIconUrl,V.Icon.Default.mergeOptions({iconRetinaUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon-2x.png",iconUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-icon.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/images/marker-shadow.png"});const v=Z,m=u(null);let a=null,y=null;const O=async()=>{if(!(!m.value||!v.occurrence))try{const{latitude:r,longitude:p}=v.occurrence;if(!r||!p){console.warn("⚠️ Coordenadas não disponíveis para o mapa");return}a=V.map(m.value,{zoomControl:v.size==="large",attributionControl:!1,dragging:v.size==="large",touchZoom:v.size==="large",doubleClickZoom:v.size==="large",scrollWheelZoom:v.size==="large",boxZoom:v.size==="large",keyboard:v.size==="large"}).setView([r,p],v.zoom),V.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"",maxZoom:18}).addTo(a);const U=l(v.occurrence.status),x=V.divIcon({className:"custom-occurrence-marker",html:`
        <div class="occurrence-marker-pin" style="background-color: ${U};">
          <div class="marker-pulse"></div>
        </div>
      `,iconSize:[24,24],iconAnchor:[12,12]});if(y=V.marker([r,p],{icon:x}).addTo(a),v.showPopup){const C=A(v.occurrence);y.bindPopup(C,{maxWidth:300,className:"custom-popup"}).openPopup()}console.log("✅ Mapa de ocorrência inicializado")}catch(r){console.error("❌ Erro ao inicializar mapa de ocorrência:",r)}},l=r=>({pending:"#f59e0b",in_progress:"#3b82f6",resolved:"#10b981",rejected:"#ef4444"})[r]||"#6b7280",E=r=>({pending:"Pendente",in_progress:"Em Andamento",resolved:"Resolvido",rejected:"Rejeitado"})[r]||r,A=r=>`
    <div class="occurrence-popup">
      <h4>${r.title||"Ocorrência sem título"}</h4>
      ${r.tags?`<p class="popup-tag"><strong>Categoria:</strong> ${r.tags.name}</p>`:""}
      <p class="popup-status"><strong>Status:</strong> ${E(r.status)}</p>
      ${r.address?`<p class="popup-address"><strong>Endereço:</strong> ${r.address}</p>`:""}
      <p class="popup-coords">
        <strong>Coordenadas:</strong> ${r.latitude.toFixed(6)}, ${r.longitude.toFixed(6)}
      </p>
    </div>
  `;return pe(()=>v.occurrence,async()=>{a&&(a.remove(),a=null,y=null),await J(),await O()}),ee(async()=>{await J(),await O()}),me(()=>{a&&(a.remove(),a=null),y=null}),(r,p)=>(i(),n("div",{class:q(["occurrence-map",{small:r.size==="small"}])},[e("div",{ref_key:"mapContainer",ref:m,class:"leaflet-map"},null,512),r.size==="small"&&r.occurrence?.address?(i(),n("div",ke,[e("div",ze,[p[0]||(p[0]=e("svg",{class:"location-icon",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),e("span",null,o(r.occurrence.address),1)])])):c("",!0)],2))}}),xe=se(Ae,[["__scopeId","data-v-d9908ebc"]]),Se={class:"occurrence-detail"},Ve={key:0,class:"loading-state"},Oe={key:1,class:"error-state"},Ee={key:2,class:"occurrence-content"},De={class:"occurrence-header"},Me={class:"header-main"},$e={class:"header-info"},Be={class:"header-meta"},Ue={class:"occurrence-id"},Le={class:"occurrence-date"},Pe={class:"header-actions"},Re={class:"management-controls"},Ie={class:"controls-row"},He={class:"status-controls"},Ne={class:"priority-controls"},je=["disabled"],Fe={key:0,class:"spinner",viewBox:"0 0 24 24"},Te={key:1,class:"check-icon",viewBox:"0 0 24 24",fill:"currentColor"},qe={class:"main-content"},Ze={class:"left-column"},Ge={class:"video-section"},We={class:"video-container"},Ye=["src"],Je={key:0,class:"video-error"},Ke={class:"error-actions"},Qe={key:0,class:"technical-info"},Xe={class:"video-info"},es={class:"video-meta"},ss={class:"video-duration"},as={class:"video-filename"},ts={key:0,class:"description-section"},os={class:"description-content"},ls={class:"updates-section"},ns={class:"add-comment"},is=["disabled"],rs={key:0,class:"updates-list"},ds={class:"update-header"},us={class:"update-author"},cs={class:"author-avatar"},vs={class:"author-info"},ps={class:"author-name"},ms={class:"update-date"},_s={key:0,class:"status-change"},gs={class:"update-content"},fs={key:1,class:"no-updates"},ys={class:"right-column"},bs={class:"location-section"},hs={class:"location-content"},Cs={key:0,class:"location-summary"},ws={class:"location-item"},ks={class:"location-text"},zs={key:0,class:"address"},As={class:"coordinates"},xs={key:0,class:"precision-badge"},Ss={class:"reporter-section"},Vs={class:"reporter-content"},Os={class:"reporter-info"},Es={class:"reporter-details"},Ds={class:"detail-item"},Ms={class:"value"},$s={class:"detail-item"},Bs={class:"value"},Us={key:0,class:"detail-item"},Ls={class:"value"},Ps={class:"assignment-section"},Rs={class:"assignment-content"},Is=["value"],Hs={key:0,class:"assigned-info"},Ns={class:"agent-info"},js={class:"agent-avatar"},Fs={class:"agent-details"},Ts={class:"agent-name"},qs={class:"agent-role"},Zs={key:0,class:"service-order-section"},Gs={class:"service-order-content"},Ws={class:"os-header"},Ys={class:"protocol-number"},Js={class:"value protocol"},Ks={class:"os-details"},Qs={class:"detail-item"},Xs={class:"value"},ea={key:0,class:"detail-item"},sa={class:"value"},aa={key:1,class:"detail-item"},ta={key:2,class:"detail-item"},oa={class:"value"},la={class:"detail-item"},na={class:"value"},ia={key:3,class:"detail-item"},ra={class:"value"},da={class:"os-actions"},ua=["disabled"],ca={class:"metadata-section"},va={class:"metadata-content"},pa={class:"detail-item"},ma={class:"value"},_a={class:"detail-item"},ga={class:"value"},fa={key:0,class:"detail-item"},ya={class:"value"},ba={key:1,class:"detail-item"},ha={class:"value"},Ca={key:2,class:"detail-item noise-data-section"},wa={class:"noise-stats"},ka={class:"noise-stat"},za={class:"noise-stat"},Aa={class:"noise-stat"},xa={class:"noise-stat"},Sa={class:"noise-level"},Va=X({__name:"OccurrenceDetailView",setup(Z){const m=_e().params.id,a=u(null),y=u([]),O=u([]),l=u(null),E=u(!1),A=u(""),r=u(!1),p=u(""),U=u(""),x=u(!1),C=u("pending"),L=u(1),w=u("pending"),k=u(1),S=u(!1),P=u(""),D=u("created"),M=u(),b=u(!1),R=u(!1),z=u({filename:"",size:0,status:"Não verificado"}),N=async()=>{E.value=!0,A.value="";try{const t=await f.getOccurrenceById(m);if(a.value=t,C.value=t.status,L.value=t.priority,w.value=t.status,k.value=t.priority,P.value=t.assigned_to||"",t.video_filename||t.video_url)try{let s=t.video_filename;if(!s&&t.video_url){const $=t.video_url.split("/");s=$[$.length-1]}const h=await f.findVideoFile(s)||s;console.log("Attempting to load video:",h);const Y=await f.getVideoSignedUrl(h);if(z.value.filename=h,z.value.status="Arquivo encontrado e URL gerada",h.includes(".dat")){console.log("Detected encrypted file, will show error with technical details"),b.value=!0,z.value.status="Arquivo criptografado detectado";try{const $=await fetch(Y,{method:"HEAD"});z.value.size=parseInt($.headers.get("content-length")||"0")}catch{console.log("Could not get file size")}a.value&&(a.value.video_url="https://sample-videos.com/zip/10/mp4/720/SampleVideo_720x480_1mb.mp4")}else a.value&&(a.value.video_url=Y,b.value=!1)}catch{console.log("Video loading failed completely, using demo video"),b.value=!0,a.value&&(a.value.video_url="https://sample-videos.com/zip/10/mp4/720/SampleVideo_720x480_1mb.mp4")}else console.log("No video information available, using demo"),b.value=!0,a.value&&(a.value.video_url="https://sample-videos.com/zip/10/mp4/720/SampleVideo_720x480_1mb.mp4")}catch(t){A.value=t.message||"Erro ao carregar ocorrência"}finally{E.value=!1}},j=async()=>{try{y.value=await f.getOccurrenceUpdates(m)}catch(t){console.error("Error loading updates:",t)}},ae=async()=>{try{O.value=await f.getAgents()}catch(t){console.error("Error loading agents:",t)}},F=async()=>{try{const t=await f.getServiceOrderByOccurrenceId(m);l.value=t,t&&(D.value=t.status)}catch(t){console.error("Error loading service order:",t)}},te=async()=>{try{await f.updateOccurrenceStatus(m,C.value,P.value),await N()}catch(t){console.error("Error updating assignment:",t)}},oe=async()=>{if(p.value.trim()){r.value=!0;try{await f.addOccurrenceUpdate(m,p.value.trim()),p.value="",await j()}catch(t){console.error("Error adding comment:",t)}finally{r.value=!1}}},le=()=>{M.value&&(U.value=Math.round(M.value.duration).toString(),b.value=!1)},ne=()=>{b.value=!0,console.log("Video loading error - this is expected for demo purposes")},ie=()=>{a.value&&(a.value.video_url="https://sample-videos.com/zip/10/mp4/720/SampleVideo_720x480_1mb.mp4",b.value=!1,M.value&&M.value.load())},_=t=>Ce(new Date(t),"dd/MM/yyyy HH:mm",{locale:we}),re=async()=>{if(l.value)try{const t=D.value==="completed"?new Date().toISOString():void 0;await f.updateServiceOrderStatus(l.value.id,D.value,t),await F()}catch(t){console.error("Error updating service order status:",t)}},de=async()=>{if(l.value){x.value=!0;try{const t=`
ORDEM DE SERVIÇO - ${l.value.protocol_number}

Título: ${l.value.title}
Status: ${G(l.value.status)}
Prioridade: ${l.value.priority}/5
${l.value.due_date?`Data Limite: ${_(l.value.due_date)}`:""}

Descrição:
${l.value.description}

${l.value.assigned_agent?`Responsável: ${l.value.assigned_agent.full_name}`:""}

Criada em: ${_(l.value.created_at)}
${l.value.completed_at?`Concluída em: ${_(l.value.completed_at)}`:""}

Sistema CITY 4C - Gerado automaticamente
    `.trim(),s=new Blob([t],{type:"text/plain"}),d=window.URL.createObjectURL(s),h=document.createElement("a");h.href=d,h.download=`OS_${l.value.protocol_number}.txt`,h.click(),window.URL.revokeObjectURL(d)}catch(t){console.error("Error exporting service order:",t)}finally{x.value=!1}}},ue=t=>new Date(t)<new Date,G=t=>({created:"Criada",in_progress:"Em Andamento",completed:"Concluída",cancelled:"Cancelada"})[t]||t,ce=t=>({pending:"Pendente",in_progress:"Em Andamento",resolved:"Resolvido",rejected:"Rejeitado"})[t]||t,W=ge(()=>w.value!==C.value||k.value!==L.value),ve=async()=>{if(!(!W.value||S.value)){S.value=!0;try{w.value!==C.value&&(await f.updateOccurrenceStatus(m,w.value),C.value=w.value),k.value!==L.value&&(await f.updateOccurrencePriority(m,k.value),L.value=k.value),await N(),await j(),await F(),console.log("✅ Alterações aplicadas com sucesso")}catch(t){console.error("❌ Erro ao aplicar alterações:",t)}finally{S.value=!1}}},T=t=>t?t<30?"#10B981":t<50?"#84CC16":t<60?"#EAB308":t<70?"#F97316":t<80?"#EF4444":"#DC2626":"#6B7280";return ee(()=>{N(),j(),ae(),F()}),(t,s)=>(i(),n("div",Se,[E.value?(i(),n("div",Ve,s[8]||(s[8]=[e("div",{class:"spinner"},null,-1),e("p",null,"Carregando detalhes da ocorrência...",-1)]))):A.value?(i(),n("div",Oe,[s[9]||(s[9]=e("div",{class:"error-icon"},"⚠️",-1)),s[10]||(s[10]=e("h3",null,"Erro ao carregar ocorrência",-1)),e("p",null,o(A.value),1),e("button",{onClick:s[0]||(s[0]=d=>t.$router.go(-1)),class:"btn btn-secondary"}," Voltar ")])):a.value?(i(),n("div",Ee,[e("div",De,[e("div",Me,[e("button",{onClick:s[1]||(s[1]=d=>t.$router.go(-1)),class:"back-button"},s[11]||(s[11]=[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"})],-1),g(" Voltar ",-1)])),e("div",$e,[e("h1",null,o(a.value.title||"Ocorrência sem título"),1),e("div",Be,[a.value.tags?(i(),n("span",{key:0,class:"occurrence-tag",style:I({backgroundColor:a.value.tags.color+"20",color:a.value.tags.color})},o(a.value.tags.name),5)):c("",!0),e("span",Ue,"ID: "+o(a.value.id.substring(0,8))+"...",1),e("span",Le,o(_(a.value.created_at)),1)])])]),e("div",Pe,[e("div",Re,[e("div",Ie,[e("div",He,[s[13]||(s[13]=e("label",{for:"status-select",class:"control-label"},[e("svg",{class:"label-icon",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})]),g(" Status: ")],-1)),B(e("select",{id:"status-select","onUpdate:modelValue":s[2]||(s[2]=d=>w.value=d),class:"form-select status-select"},s[12]||(s[12]=[e("option",{value:"pending"},"Pendente",-1),e("option",{value:"in_progress"},"Em Andamento",-1),e("option",{value:"resolved"},"Resolvido",-1),e("option",{value:"rejected"},"Rejeitado",-1)]),512),[[H,w.value]])]),e("div",Ne,[s[15]||(s[15]=e("label",{for:"priority-select",class:"control-label"},[e("svg",{class:"label-icon",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M13 10V3L4 14h7v7l9-11h-7z"})]),g(" Prioridade: ")],-1)),B(e("select",{id:"priority-select","onUpdate:modelValue":s[3]||(s[3]=d=>k.value=d),class:"form-select priority-select"},s[14]||(s[14]=[fe('<option value="1" data-v-46f6207d>Mínima</option><option value="2" data-v-46f6207d>Baixa</option><option value="3" data-v-46f6207d>Média</option><option value="4" data-v-46f6207d>Alta</option><option value="5" data-v-46f6207d>Crítica</option>',5)]),512),[[H,k.value]])])]),e("button",{onClick:ve,disabled:!W.value||S.value,class:"apply-button"},[S.value?(i(),n("svg",Fe,s[16]||(s[16]=[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4",fill:"none",opacity:"0.25"},null,-1),e("path",{fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(i(),n("svg",Te,s[17]||(s[17]=[e("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))),g(" "+o(S.value?"Aplicando...":"Aplicar Alterações"),1)],8,je)])])]),e("div",qe,[e("div",Ze,[e("div",Ge,[s[26]||(s[26]=e("h2",null,"Vídeo da Ocorrência",-1)),e("div",We,[e("video",{ref_key:"videoPlayer",ref:M,src:a.value.video_url,controls:"",preload:"metadata",class:"video-player",onLoadedmetadata:le,onError:ne}," Seu navegador não suporta o elemento de vídeo. ",40,Ye),b.value?(i(),n("div",Je,[s[24]||(s[24]=e("p",null,"🔒 Vídeo Protegido por Criptografia",-1)),s[25]||(s[25]=e("p",{class:"error-details"},"Este vídeo foi criptografado pelo aplicativo móvel para segurança. O sistema web atual não tem as chaves de descriptografia. Carregando vídeo de demonstração...",-1)),e("div",Ke,[e("button",{onClick:ie,class:"btn btn-primary"},"🎬 Assistir Vídeo Demo"),e("button",{onClick:s[4]||(s[4]=d=>R.value=!R.value),class:"btn btn-secondary"},o(R.value?"Ocultar":"Ver")+" Detalhes Técnicos ",1)]),R.value?(i(),n("div",Qe,[s[22]||(s[22]=e("h4",null,"Informações Técnicas:",-1)),e("ul",null,[e("li",null,[s[18]||(s[18]=e("strong",null,"Arquivo encontrado:",-1)),g(" ✅ Sim ("+o(z.value.filename)+")",1)]),e("li",null,[s[19]||(s[19]=e("strong",null,"Tamanho:",-1)),g(" "+o(z.value.size)+" bytes",1)]),s[21]||(s[21]=e("li",null,[e("strong",null,"Formato:"),g(" .dat (criptografado)")],-1)),e("li",null,[s[20]||(s[20]=e("strong",null,"Status:",-1)),g(" "+o(z.value.status),1)])]),s[23]||(s[23]=e("p",{class:"tech-note"}," 💡 Para reproduzir este vídeo, seria necessário implementar a descriptografia no frontend ou ter uma API que descriptografe os arquivos. ",-1))])):c("",!0)])):c("",!0),e("div",Xe,[e("div",es,[e("span",ss," Duração: "+o(a.value.video_duration||U.value)+"s ",1),e("span",as," Arquivo: "+o(a.value.video_filename),1)])])])]),a.value.description?(i(),n("div",ts,[s[27]||(s[27]=e("h2",null,"Descrição",-1)),e("div",os,[e("p",null,o(a.value.description),1)])])):c("",!0),e("div",ls,[s[30]||(s[30]=e("h2",null,"Atualizações",-1)),e("div",ns,[e("form",{onSubmit:ye(oe,["prevent"]),class:"comment-form"},[B(e("textarea",{"onUpdate:modelValue":s[5]||(s[5]=d=>p.value=d),placeholder:"Adicione uma atualização ou comentário...",class:"form-textarea",rows:"3",required:""},null,512),[[be,p.value]]),e("button",{type:"submit",class:"btn btn-primary",disabled:!p.value.trim()||r.value},o(r.value?"Adicionando...":"Adicionar Comentário"),9,is)],32)]),y.value.length>0?(i(),n("div",rs,[(i(!0),n(K,null,Q(y.value,d=>(i(),n("div",{key:d.id,class:"update-item"},[e("div",ds,[e("div",us,[e("div",cs,o(d.profiles?.full_name?.[0]||"U"),1),e("div",vs,[e("span",ps,o(d.profiles?.full_name||"Usuário"),1),e("span",ms,o(_(d.created_at)),1)])]),d.status_change?(i(),n("div",_s,[s[28]||(s[28]=g(" Status alterado para: ",-1)),e("strong",null,o(ce(d.status_change)),1)])):c("",!0)]),e("div",gs,[e("p",null,o(d.comment),1)])]))),128))])):(i(),n("div",fs,s[29]||(s[29]=[e("p",null,"Nenhuma atualização ainda. Seja o primeiro a comentar!",-1)])))])]),e("div",ys,[e("div",bs,[s[33]||(s[33]=e("h3",null,"Localização",-1)),e("div",hs,[he(xe,{occurrence:a.value,size:"large",zoom:16,class:"occurrence-location-map"},null,8,["occurrence"]),a.value.address||a.value.latitude?(i(),n("div",Cs,[e("div",ws,[s[31]||(s[31]=e("svg",{class:"location-icon",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})],-1)),e("div",ks,[a.value.address?(i(),n("span",zs,o(a.value.address),1)):c("",!0),e("span",As,o(a.value.latitude.toFixed(6))+", "+o(a.value.longitude.toFixed(6)),1)])]),a.value.location_accuracy?(i(),n("div",xs,[s[32]||(s[32]=e("svg",{class:"precision-icon",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0013 3.06V1h-2v2.06A8.994 8.994 0 003.06 11H1v2h2.06A8.994 8.994 0 0011 20.94V23h2v-2.06A8.994 8.994 0 0020.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"})],-1)),e("span",null,o(a.value.location_accuracy.toFixed(1))+"m de precisão",1)])):c("",!0)])):c("",!0)])]),e("div",Ss,[s[38]||(s[38]=e("h3",null,"Informações do Relator",-1)),e("div",Vs,[e("div",Os,[s[37]||(s[37]=e("div",{class:"reporter-avatar"},[e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"})])],-1)),e("div",Es,[e("div",Ds,[s[34]||(s[34]=e("span",{class:"label"},"Nome:",-1)),e("span",Ms,o(a.value.profiles?.full_name||"Anônimo"),1)]),e("div",$s,[s[35]||(s[35]=e("span",{class:"label"},"Tipo:",-1)),e("span",Bs,o(a.value.reporter_type==="agent"?"Agente Público":"Cidadão"),1)]),a.value.profiles?.department?(i(),n("div",Us,[s[36]||(s[36]=e("span",{class:"label"},"Departamento:",-1)),e("span",Ls,o(a.value.profiles.department),1)])):c("",!0)])])])]),e("div",Ps,[s[40]||(s[40]=e("h3",null,"Responsável",-1)),e("div",Rs,[B(e("select",{"onUpdate:modelValue":s[6]||(s[6]=d=>P.value=d),onChange:te,class:"form-select"},[s[39]||(s[39]=e("option",{value:""},"Não atribuído",-1)),(i(!0),n(K,null,Q(O.value,d=>(i(),n("option",{key:d.id,value:d.id},o(d.full_name||d.id),9,Is))),128))],544),[[H,P.value]]),a.value.assigned_agent?(i(),n("div",Hs,[e("div",Ns,[e("div",js,o(a.value.assigned_agent.full_name?.[0]||"A"),1),e("div",Fs,[e("span",Ts,o(a.value.assigned_agent.full_name||"Agente"),1),e("span",qs,o(a.value.assigned_agent.department||a.value.assigned_agent.role),1)])])])):c("",!0)])]),l.value?(i(),n("div",Zs,[s[50]||(s[50]=e("h3",null,[e("svg",{viewBox:"0 0 24 24",fill:"currentColor",class:"section-icon"},[e("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})]),g(" Ordem de Serviço ")],-1)),e("div",Gs,[e("div",Ws,[e("div",Ys,[s[41]||(s[41]=e("span",{class:"label"},"Protocolo:",-1)),e("span",Js,o(l.value.protocol_number),1)]),e("div",{class:q(["os-status","os-status--"+l.value.status])},o(G(l.value.status)),3)]),e("div",Ks,[e("div",Qs,[s[42]||(s[42]=e("span",{class:"label"},"Título:",-1)),e("span",Xs,o(l.value.title),1)]),l.value.estimated_duration_hours?(i(),n("div",ea,[s[43]||(s[43]=e("span",{class:"label"},"Prazo Estimado:",-1)),e("span",sa,o(l.value.estimated_duration_hours)+"h",1)])):c("",!0),l.value.due_date?(i(),n("div",aa,[s[44]||(s[44]=e("span",{class:"label"},"Data Limite:",-1)),e("span",{class:q(["value due-date",{overdue:ue(l.value.due_date)}])},o(_(l.value.due_date)),3)])):c("",!0),l.value.assigned_agent?(i(),n("div",ta,[s[45]||(s[45]=e("span",{class:"label"},"Responsável:",-1)),e("span",oa,o(l.value.assigned_agent.full_name),1)])):c("",!0),e("div",la,[s[46]||(s[46]=e("span",{class:"label"},"Criada em:",-1)),e("span",na,o(_(l.value.created_at)),1)]),l.value.completed_at?(i(),n("div",ia,[s[47]||(s[47]=e("span",{class:"label"},"Concluída em:",-1)),e("span",ra,o(_(l.value.completed_at)),1)])):c("",!0)]),e("div",da,[B(e("select",{"onUpdate:modelValue":s[7]||(s[7]=d=>D.value=d),onChange:re,class:"form-select"},s[48]||(s[48]=[e("option",{value:"created"},"Criada",-1),e("option",{value:"in_progress"},"Em Andamento",-1),e("option",{value:"completed"},"Concluída",-1),e("option",{value:"cancelled"},"Cancelada",-1)]),544),[[H,D.value]]),e("button",{onClick:de,class:"btn btn-secondary btn-sm",disabled:x.value},[s[49]||(s[49]=e("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"})],-1)),g(" "+o(x.value?"Exportando...":"Exportar OS"),1)],8,ua)])])])):c("",!0),e("div",ca,[s[60]||(s[60]=e("h3",null,"Metadados",-1)),e("div",va,[e("div",pa,[s[51]||(s[51]=e("span",{class:"label"},"Criado em:",-1)),e("span",ma,o(_(a.value.created_at)),1)]),e("div",_a,[s[52]||(s[52]=e("span",{class:"label"},"Atualizado em:",-1)),e("span",ga,o(_(a.value.updated_at)),1)]),a.value.resolved_at?(i(),n("div",fa,[s[53]||(s[53]=e("span",{class:"label"},"Resolvido em:",-1)),e("span",ya,o(_(a.value.resolved_at)),1)])):c("",!0),a.value.metadata?(i(),n("div",ba,[s[54]||(s[54]=e("span",{class:"label"},"Dispositivo:",-1)),e("span",ha,o(a.value.metadata.device_info?.platform||"N/A"),1)])):c("",!0),a.value.metadata?.noise_data?(i(),n("div",Ca,[s[59]||(s[59]=e("span",{class:"label"},"Dados de Ruído:",-1)),e("div",wa,[e("div",ka,[s[55]||(s[55]=e("span",{class:"noise-label"},"Atual:",-1)),e("span",{class:"noise-value",style:I({color:T(a.value.metadata.noise_data.current_db)})},o(a.value.metadata.noise_data.current_db?.toFixed(1)||"N/A")+" dB ",5)]),e("div",za,[s[56]||(s[56]=e("span",{class:"noise-label"},"Máximo:",-1)),e("span",{class:"noise-value",style:I({color:T(a.value.metadata.noise_data.max_db)})},o(a.value.metadata.noise_data.max_db?.toFixed(1)||"N/A")+" dB ",5)]),e("div",Aa,[s[57]||(s[57]=e("span",{class:"noise-label"},"Média:",-1)),e("span",{class:"noise-value",style:I({color:T(a.value.metadata.noise_data.avg_db)})},o(a.value.metadata.noise_data.avg_db?.toFixed(1)||"N/A")+" dB ",5)]),e("div",xa,[s[58]||(s[58]=e("span",{class:"noise-label"},"Nível:",-1)),e("span",Sa,o(a.value.metadata.noise_data.noise_level||"N/A"),1)])])])):c("",!0)])])])])])):c("",!0)]))}}),Ma=se(Va,[["__scopeId","data-v-46f6207d"]]);export{Ma as default};
