import{d as A,a as u,r as U,y as q,c as l,b as t,f,j as E,F as h,z,t as d,w as B,g as y,v as k,B as v,C as M,n as T,p as i,_ as H}from"./index-BIMyVpsT.js";const I={class:"tags-view"},P={class:"tags-header"},j={key:0,class:"loading-state"},G={key:1,class:"tags-grid"},O={class:"tag-header"},J={class:"tag-info"},K={key:0},Q={class:"tag-stats"},R={class:"stat-item"},W={class:"stat-value"},X={class:"stat-item"},Y={class:"tag-actions"},Z=["onClick"],tt=["onClick","title"],at={key:0,viewBox:"0 0 24 24",fill:"currentColor"},ot={key:1,viewBox:"0 0 24 24",fill:"currentColor"},st=["onClick","disabled"],et={key:2,class:"empty-state"},lt={class:"modal-header"},it={class:"form-group"},rt={class:"form-group"},nt={class:"form-group"},dt={class:"color-input-group"},ct={class:"color-presets"},ut={class:"preset-colors"},vt=["onClick"],pt={class:"modal-actions"},gt=["disabled"],mt={class:"modal-body"},Ct={class:"modal-actions"},bt=["disabled"],ft=A({__name:"TagsView",setup(yt){const p=u([]),g=u(!1),r=u(!1),m=u(!1),c=u(null),n=u(null),e=U({name:"",description:"",color:"#3B82F6"}),F=["#EF4444","#F59E0B","#10B981","#3B82F6","#8B5CF6","#EC4899","#6B7280","#84CC16","#06B6D4","#F97316"],_=u({}),C=async()=>{g.value=!0;try{p.value=await v.getTags(),p.value.forEach(s=>{_.value[s.id]=Math.floor(Math.random()*25)})}catch(s){console.error("Error loading tags:",s)}finally{g.value=!1}},V=s=>{c.value=s,e.name=s.name,e.description=s.description||"",e.color=s.color},S=s=>{if(x(s.id)>0){alert("Não é possível excluir uma categoria que possui ocorrências associadas.");return}n.value=s},b=()=>{m.value=!1,c.value=null,L()},L=()=>{e.name="",e.description="",e.color="#3B82F6"},$=async()=>{r.value=!0;try{const s={name:e.name.trim(),description:e.description.trim()||void 0,color:e.color,is_active:!0};c.value?await v.updateTag(c.value.id,s):await v.createTag(s),await C(),b()}catch(s){console.error("Error saving tag:",s),alert("Erro ao salvar categoria. Tente novamente.")}finally{r.value=!1}},D=async s=>{try{await v.updateTag(s.id,{is_active:!s.is_active}),await C()}catch(a){console.error("Error toggling tag status:",a),alert("Erro ao alterar status da categoria.")}},N=async()=>{if(n.value){r.value=!0;try{await v.deleteTag(n.value.id),await C(),n.value=null}catch(s){console.error("Error deleting tag:",s),alert("Erro ao excluir categoria.")}finally{r.value=!1}}},x=s=>_.value[s]||0;return q(()=>{C()}),(s,a)=>(i(),l("div",I,[t("div",P,[a[11]||(a[11]=t("div",{class:"header-content"},[t("h1",null,"Gerenciar Categorias"),t("p",null,"Configure as categorias disponíveis para classificação das ocorrências.")],-1)),t("button",{onClick:a[0]||(a[0]=o=>m.value=!0),class:"btn btn-primary"},a[10]||(a[10]=[t("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"})],-1),E(" Nova Categoria ",-1)]))]),g.value?(i(),l("div",j,a[12]||(a[12]=[t("div",{class:"spinner"},null,-1),t("p",null,"Carregando categorias...",-1)]))):(i(),l("div",G,[(i(!0),l(h,null,z(p.value,o=>(i(),l("div",{key:o.id,class:"tag-card"},[t("div",O,[t("div",{class:"tag-color",style:M({backgroundColor:o.color})},null,4),t("div",J,[t("h3",null,d(o.name),1),o.description?(i(),l("p",K,d(o.description),1)):f("",!0)])]),t("div",Q,[t("div",R,[a[13]||(a[13]=t("span",{class:"stat-label"},"Ocorrências:",-1)),t("span",W,d(x(o.id)),1)]),t("div",X,[a[14]||(a[14]=t("span",{class:"stat-label"},"Status:",-1)),t("span",{class:T(["status-badge",o.is_active?"status-active":"status-inactive"])},d(o.is_active?"Ativa":"Inativa"),3)])]),t("div",Y,[t("button",{onClick:w=>V(o),class:"action-btn action-btn--edit",title:"Editar categoria"},a[15]||(a[15]=[t("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"})],-1)]),8,Z),t("button",{onClick:w=>D(o),class:T(["action-btn",o.is_active?"action-btn--deactivate":"action-btn--activate"]),title:o.is_active?"Desativar categoria":"Ativar categoria"},[o.is_active?(i(),l("svg",at,a[16]||(a[16]=[t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"},null,-1)]))):(i(),l("svg",ot,a[17]||(a[17]=[t("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z"},null,-1)])))],10,tt),t("button",{onClick:w=>S(o),class:"action-btn action-btn--delete",title:"Excluir categoria",disabled:x(o.id)>0},a[18]||(a[18]=[t("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"})],-1)]),8,st)])]))),128))])),!g.value&&p.value.length===0?(i(),l("div",et,[a[19]||(a[19]=t("svg",{class:"empty-icon",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 2 2 2h11c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"})],-1)),a[20]||(a[20]=t("h3",null,"Nenhuma categoria criada",-1)),a[21]||(a[21]=t("p",null,"Crie sua primeira categoria para começar a organizar as ocorrências.",-1)),t("button",{onClick:a[1]||(a[1]=o=>m.value=!0),class:"btn btn-primary"}," Criar Primeira Categoria ")])):f("",!0),m.value||c.value?(i(),l("div",{key:3,class:"modal-overlay",onClick:b},[t("div",{class:"modal-content",onClick:a[6]||(a[6]=B(()=>{},["stop"]))},[t("div",lt,[t("h2",null,d(c.value?"Editar Categoria":"Nova Categoria"),1),t("button",{onClick:b,class:"close-button"},a[22]||(a[22]=[t("svg",{viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"})],-1)]))]),t("form",{onSubmit:B($,["prevent"]),class:"modal-form"},[t("div",it,[a[23]||(a[23]=t("label",{for:"tag-name",class:"form-label"},"Nome *",-1)),y(t("input",{id:"tag-name","onUpdate:modelValue":a[2]||(a[2]=o=>e.name=o),type:"text",class:"form-input",placeholder:"Ex: Lixo, Iluminação, Pavimentação...",required:"",maxlength:"50"},null,512),[[k,e.name]])]),t("div",rt,[a[24]||(a[24]=t("label",{for:"tag-description",class:"form-label"},"Descrição",-1)),y(t("textarea",{id:"tag-description","onUpdate:modelValue":a[3]||(a[3]=o=>e.description=o),class:"form-textarea",placeholder:"Descrição detalhada da categoria...",rows:"3",maxlength:"200"},null,512),[[k,e.description]])]),t("div",nt,[a[25]||(a[25]=t("label",{for:"tag-color",class:"form-label"},"Cor *",-1)),t("div",dt,[y(t("input",{id:"tag-color","onUpdate:modelValue":a[4]||(a[4]=o=>e.color=o),type:"color",class:"color-input",required:""},null,512),[[k,e.color]]),y(t("input",{"onUpdate:modelValue":a[5]||(a[5]=o=>e.color=o),type:"text",class:"form-input color-text",placeholder:"#3B82F6",pattern:"^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$"},null,512),[[k,e.color]])]),a[26]||(a[26]=t("small",{class:"form-help"},"Escolha uma cor que represente bem esta categoria",-1))]),t("div",ct,[a[27]||(a[27]=t("span",{class:"presets-label"},"Cores sugeridas:",-1)),t("div",ut,[(i(),l(h,null,z(F,o=>t("button",{key:o,type:"button",class:T(["preset-color",{active:e.color===o}]),style:M({backgroundColor:o}),onClick:w=>e.color=o},null,14,vt)),64))])]),t("div",pt,[t("button",{type:"button",onClick:b,class:"btn btn-secondary"}," Cancelar "),t("button",{type:"submit",class:"btn btn-primary",disabled:r.value||!e.name||!e.color},d(r.value?"Salvando...":c.value?"Salvar Alterações":"Criar Categoria"),9,gt)])],32)])])):f("",!0),n.value?(i(),l("div",{key:4,class:"modal-overlay",onClick:a[9]||(a[9]=o=>n.value=null)},[t("div",{class:"modal-content modal-content--small",onClick:a[8]||(a[8]=B(()=>{},["stop"]))},[a[31]||(a[31]=t("div",{class:"modal-header"},[t("h2",null,"Confirmar Exclusão")],-1)),t("div",mt,[t("p",null,[a[28]||(a[28]=E(" Tem certeza que deseja excluir a categoria ",-1)),t("strong",null,'"'+d(n.value.name)+'"',1),a[29]||(a[29]=E("? ",-1))]),a[30]||(a[30]=t("p",{class:"warning-text"}," Esta ação não pode ser desfeita. ",-1))]),t("div",Ct,[t("button",{onClick:a[7]||(a[7]=o=>n.value=null),class:"btn btn-secondary"}," Cancelar "),t("button",{onClick:N,class:"btn btn-danger",disabled:r.value},d(r.value?"Excluindo...":"Excluir"),9,bt)])])])):f("",!0)]))}}),xt=H(ft,[["__scopeId","data-v-5ac693eb"]]);export{xt as default};
